const SVG_sharp_save_alt='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3" display="none"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4" display="none"></g><path d="M19,12v7H5v-7H3v9h18v-9H19z M13,12.67l2.59-2.58L17,11.5l-5,5l-5-5l1.41-1.41L11,12.67V3h2V12.67z"/></g></svg>';const SVG_sharp_save='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px"height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3" display="none"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4" display="none"></g><path d="M17,3H3v18h18V7L17,3z M12,19c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3S13.66,19,12,19z M15,9H5V5h10V9z"/></g></svg>';const SVG_sharp_delete='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4"></g><path d="M6,21h12V7H6V21z M19,4h-3.5l-1-1h-5l-1,1H5v2h14V4z"/></g></svg>';const SVG_sharp_playlist_add='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"> <path fill="none" d="M0,0h24v24H0V0z"/></g>\<g id="Sharp"><path d="M14,10H2v2h12V10z M14,6H2v2h12V6z M2,16h8v-2H2V16z M21.5,11.5L23,13l-6.99,7l-4.51-4.5L13,14l3.01,3L21.5,11.5z"/></g></svg>';const SVG_sharp_edit='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_2"></g><path d="M3,17.25V21h3.75L17.81,9.94l-3.75-3.75L3,17.25z M21.41,6.34l-3.75-3.75l-2.53,2.54l3.75,3.75L21.41,6.34z"/></g></svg>';const SVG_sharp_list_alt='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_2"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4"></g><g><rect x="11" y="7" width="6" height="2"/><rect x="11" y="11" width="6" height="2"/><rect x="11" y="15" width="6" height="2"/><rect x="7" y="7" width="2" height="2"/><rect x="7" y="11" width="2" height="2"/><rect x="7" y="15" width="2" height="2"/><path d="M3,3v18h18V3H3z M19,19H5V5h14V19z"/></g></g></svg>';const SVG_sharp_playlist_add_check='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><path d="M14,10H2v2h12V10z M14,6H2v2h12V6z M2,16h8v-2H2V16z M21.5,11.5L23,13l-6.99,7l-4.51-4.5L13,14l3.01,3L21.5,11.5z"/></g></svg>';const SVG_refresh='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><path d="M17.65,6.35C16.2,4.9,14.21,4,12,4c-4.42,0-7.99,3.58-7.99,8s3.57,8,7.99,8c3.73,0,6.84-2.55,7.73-6h-2.08c-0.82,2.33-3.04,4-5.65,4c-3.31,0-6-2.69-6-6s2.69-6,6-6c1.66,0,3.14,0.69,4.22,1.78L13,11h7V4L17.65,6.35z"/></g></svg>';const SVG_sharp_search='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3" display="none"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4" display="none"></g><path d="M15.5,14h-0.79l-0.28-0.27C15.41,12.59,16,11.11,16,9.5C16,5.91,13.09,3,9.5,3S3,5.91,3,9.5S5.91,16,9.5,16c1.61,0,3.09-0.59,4.23-1.57L14,14.71v0.79l5,4.99L20.49,19L15.5,14z M9.5,14C7.01,14,5,11.99,5,9.5S7.01,5,9.5,5S14,7.01,14,9.5S11.99,14,9.5,14z"/></g></svg>';const SVG_sharp_add='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3" display="none"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4" display="none"></g><path d="M19,13h-6v6h-2v-6H5v-2h6V5h2v6h6V13z"/></g></svg>';const SVG_sharp_remove='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3" display="none"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4" display="none"></g><path d="M19,13H5v-2h14V13z"/></g></svg>'
const SVG_sharp_keyboard_arrow_left='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4"></g><path d="M15.41,16.59L10.83,12l4.58-4.59L14,6l-6,6l6,6L15.41,16.59z"/></g></svg>';const SVG_sharp_keyboard_arrow_right='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4"></g><path d="M8.59,16.59L13.17,12L8.59,7.41L10,6l6,6l-6,6L8.59,16.59z"/></g></svg>';const SVG_sharp_launch='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><g id="ui_x5F_spec_x5F_header_copy_3" display="none"></g><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><g id="ui_x5F_spec_x5F_header_copy_4" display="none"></g><path d="M19,19H5V5h7V3H3v18h18v-9h-2V19z M14,3v2h3.59l-9.83,9.83l1.41,1.41L19,6.41V10h2V3H14z"/></g></svg>';const SVG_sharp_library_add='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g id="Bounding_Boxes"><path fill="none" d="M0,0h24v24H0V0z"/></g><g id="Sharp"><path d="M4,6H2v16h16v-2H4V6z M22,2H6v16h16V2z M19,11h-4v4h-2v-4H9V9h4V5h2v4h4V11z"/></g></svg>';$(function(){svg_init()});function svg_init(){$('.svg-save').empty();$('.svg-save-us').empty();$('.svg-playlist-add').empty();$('.svg-playlist-add-check').empty();$('.svg-delete').empty();$('.svg-edit').empty();$('.svg-list-alt').empty();$('.svg-refresh').empty();$('.svg-search').empty();$('.svg-add').empty();$('.svg-remove').empty();$('.svg-key-right').empty();$('.svg-key-left').empty();$('.svg-launch').empty();$('.svg-library-add').empty();$('.svg-save').prepend(SVG_sharp_save_alt);$('.svg-save-us').prepend(SVG_sharp_save);$('.svg-playlist-add').prepend(SVG_sharp_playlist_add);$('.svg-playlist-add-check').prepend(SVG_sharp_playlist_add_check);$('.svg-delete').prepend(SVG_sharp_delete);$('.svg-edit').prepend(SVG_sharp_edit);$('.svg-list-alt').prepend(SVG_sharp_list_alt);$('.svg-refresh').prepend(SVG_refresh);$('.svg-search').prepend(SVG_sharp_search);$('.svg-add').prepend(SVG_sharp_add);$('.svg-remove').prepend(SVG_sharp_remove);$('.svg-key-right').prepend(SVG_sharp_keyboard_arrow_right);$('.svg-key-left').prepend(SVG_sharp_keyboard_arrow_left);$('.svg-launch').prepend(SVG_sharp_launch);$('.svg-library-add').prepend(SVG_sharp_library_add)}
function Array_ToCSV(content){var formatCSV='';for(var i=0;i<content.length;i++){var value=content[i];for(var j=0;j<value.length;j++){var innerValue=value[j]===null?'':value[j].toString();var result=innerValue.replace(/"/g,'""');result='"'+result+'"';if(j>0){formatCSV+=',';formatCSV+=result}
else if(j===0){formatCSV+=result}}
formatCSV+='\r\n'}
return formatCSV}
function text_ToArray(){var fso=new ActiveXObject('Scripting.FileSystemObject');var file;try{file=fso.OpenTextFile(FILE,1,!1,!1);var data=file.ReadAll()}
catch(e){msg_show('ファイル読み込みに失敗しました。(text_ToArray)</br>アプリを再起動してください','alert-danger');return}
return CSV_ToArray(data)}
function CSV_ToArray(text,delim){if(!delim)delim=',';var tokenizer=new RegExp(delim+'|\r?\n|[^'+delim+'"\r\n][^'+delim+'\r\n]*|"(?:[^"]|"")*"','g');var record=0,field=0,data=[['']],qq=/""/g;text.replace(/\r?\n$/,'').replace(tokenizer,function(token){switch(token){case delim:data[record][++field]='';break;case '\n':case '\r\n':data[++record]=[''];field=0;break;default:data[record][field]=(token.charAt(0)!='"')?token:token.slice(1,-1).replace(qq,'"')}});return data}
function on_function(e,textarea){e.preventDefault();var start=textarea.selectionStart;var end=textarea.selectionEnd;var before=textarea.value.substring(0,start);var after=textarea.value.substring(end,textarea.value.length);textarea.value=before+INDENT+after;textarea.selectionStart=textarea.selectionEnd=end+INDENT.length-(end-start)}
function getDateTime(){var d=new Date();return d.getFullYear()+'/'+('0'+(d.getMonth()+1)).slice(-2)+'/'+('0'+d.getDate()).slice(-2)+'_'+('0'+d.getHours()).slice(-2)+':'+('0'+d.getMinutes()).slice(-2)+':'+('0'+d.getSeconds()).slice(-2)}
$(function(){setWindow();loadText();all_select_item_ini();$('#table-visible').on('click',function(){$('#memo_app_msg').empty();$("#memo-input-form").removeClass("active");$("#memo-input-form").addClass("hidden_group");$("#all-memo").removeClass("hidden_group");$("#all-memo").addClass("active");$('#all-task').addClass('hidden_group')
$('#all-task').removeClass('active');all_memo_visible()});$(window).on('keydown',function(e){if(e.ctrlKey&&(e.keyCode===84)){$('#table-visible').click()}});$('#memo-visible').on('click',function(e){$('#memo_app_msg').empty();$('#memo-input-form').addClass('active');$('#memo-input-form').removeClass('hidden_group');$('#all-memo').removeClass('active');$('#all-memo').addClass('hidden_group');$('#all-task').addClass('hidden_group')
$('#all-task').removeClass('active');if(!($('#memo-input-form').prop('user-width')===undefined&&$('#memo-input-form').prop('user-height')===undefined)){setWindow($('#memo-input-form').prop('user-height'),$('#memo-input-form').prop('user-width'));if($('#conf-detail-btn').hasClass('active')){$('#conf-detail-btn').click()}}});$('#task-visible').on('click',function(){$('#memo_app_msg').empty();$('#memo-input-form').removeClass('active');$('#memo-input-form').addClass('hidden_group');$('#all-memo').removeClass('active');$('#all-memo').addClass('hidden_group');$('#all-task').removeClass('hidden_group')
$('#all-task').addClass('active');if(!($('#all-task').prop('user-width')===undefined&&$('#all-task').prop('user-height')===undefined)){setWindow($('#all-task').prop('user-height'),$('#all-task').prop('user-width'))}
all_task_visible()});$('#page-reload').on('click',function(e){if($("#memo-input-form").hasClass("active")){$("#memo-input-form").removeClass("hidden_group");$("#all-memo").addClass("hidden_group");$("#all-memo").removeClass("active");$("#all-task").addClass("hidden_group");$("#all-task").removeClass("active")}else if($("#all-memo").hasClass("active")){$("#memo-input-form").addClass("hidden_group");$("#memo-input-form").removeClass("active");$("#all-memo").removeClass("hidden_group");$("#all-task").addClass("hidden_group");$("#all-task").removeClass("active")}else if($('#all-task').hasClass("active")){$("#memo-input-form").addClass("hidden_group");$("#memo-input-form").removeClass("active");$("#all-memo").addClass("hidden_group");$("#all-memo").removeClass("active");$("#all-task").removeClass("hidden_group")}
$('#memo_app_msg').empty()});$('#save').on('click',function(e){saveText();loadText($('#memo_id').text(),0,1)});$(window).on('keydown',function(e){if(e.ctrlKey&&(e.keyCode===83)){saveText();loadText($('#memo_id').text(),0,1)}});var timer=!1;$(window).resize(function(){if(timer!==!1){clearTimeout(timer)}
timer=setTimeout(function(){if($("#memo-input-form").hasClass("active")){$('#memo-input-form').prop('user-height',window.outerHeight);$('#memo-input-form').prop('user-width',window.outerWidth)}else if($("#all-memo").hasClass("active")){$('#all-memo').prop('user-height',window.outerHeight);$('#all-memo').prop('user-width',window.outerWidth);$('tbody.scrollBody').css({"height":Number(window.outerHeight-170)+"px","width":Number(window.outerWidth-18)+"px"})}else if($("#all-task").hasClass("active")){$('#all-task').prop('user-height',window.outerHeight);$('#all-task').prop('user-width',window.outerWidth);$('#all-task .scrollBody').css({"height":Number(window.outerHeight-85)+"px","width":Number(window.outerWidth-18)+"px"})}},200)});$('#delete').on('click',function(e){var id=$('#memo_id').text();bootbox.confirm({message:"ファイルが削除されます。よろしいですか?",buttons:{confirm:{label:'OK',className:'btn-danger'},cancel:{label:'Cancel',className:''}},callback:function(result){if(result){delete_text();loadText(("00000"+(Number(id)-1)).slice(-5))}else{msg_show("Cancelしました。")}}})});$('#save_us').on('click',function(e){save_as()});$('#conf-detail-btn').on('click',acordion_move);$(window).on('keydown',function(e){if(e.ctrlKey&&(e.keyCode===68)){$('#conf-detail-btn').click()}});$('#new').on('click',function(e){saveText($('#memo_id').text(),0,1);var id=$('#memo_id').text();var last=("00000"+(Number(get_last_id())+1)).slice(-5)
if(("00000"+(Number(id)+1)).slice(-5)===last){msg_show('最新のデータです。')}else{loadText(("00000"+(Number(id)+1)).slice(-5))}});$('#pre').on('click',function(e){saveText($('#memo_id').text(),0,1);var id=$('#memo_id').text();if(("00000"+(Number(id)-1)).slice(-5)==="00000"){msg_show('最後のデータです。')}else{loadText(("00000"+(Number(id)-1)).slice(-5))}});$('#add').on('click',function(e){loadText(1,1)});$(window).on('keydown',function(e){if(e.ctrlKey&&(e.keyCode===82)){$('#add').click()}});$('#memo-table').on('click','[id*="memo_id--"]',function(){$("#memo-input-form").removeClass("hidden_group");$("#all-memo").addClass("hidden_group");setWindow();loadText($(this).text())});$('#memo-table').on('click','.td-group',function(){if($(this).hasClass('active')){$(this).removeClass('active')}
else{$(this).addClass('active')}});$('#line-set').on('click',function(){all_memo_visible($('#all-memo .num').val())});$('#all-memo .pre').on('click',function(){var last_id=Number($('#visible-last-id').text())+(Number($('#all-memo .num').val())*2);all_memo_visible($('#all-memo .num').val(),last_id)});$('#all-memo .next').on('click',function(){all_memo_visible($('#all-memo .num').val(),$('#visible-last-id').text())});$(document).on('focus',".datepickr",function(){$(this).flatpickr({enableTime:!0,dateFormat:"Y-m-d-H:i",defaultDate:new Date()})});$(document).on('click','#new-task-add .add',function(){task_add()})
$(document).on('click',"#all-task-table .del",function(){var task_id=$(this).parent().parent().attr('id');task_del(task_id.slice(task_id.search('[^task-num-]')))})
$(document).on('click',"#all-task-table .save",function(){task_save($(this).parent().parent().attr('id'))})
$(document).on('click',"#new-task-add .all-save",function(){task_all_save()})
var $textarea=$('.task-text');var lineHeight=parseInt($textarea.css('lineHeight'));$(document).on('click',".task-text",function(e){var lines=($(this).val()+'\n').match(/\n/g).length;$(this).height(lineHeight*lines)});$(document).on('input',".task-text",function(e){var lines=($(this).val()+'\n').match(/\n/g).length;$(this).height(lineHeight*lines)})});function loadText(id,new_flg){var last_id=get_last_id();var new_id=Number(last_id.slice(last_id.search('[^0]')))+1;if(id===undefined){id=last_id;if(last_id==='00000'){id='00001'}}
else if(new_flg===1){var id=('00000'+new_id).slice(-5)}
else if(Number(id.slice(id.search('[^0]')))>=new_id){id="00001"}
else if(Number(id.slice(id.search('[^0]')))<=0){id=last_id}
var file=FILE+id+".json";var init_data='{"id":"'+id+'","title":"","memo":"","create_time":"'+getDateTime()+'","update_time":"","hidden_flg":0,"group1":"00:Group1","group2":"00:Group2"}'
var data=file_rw(file,0);if(data===undefined||id>last_id){file_rw(file,1,init_data);msg_show('管理番号: '+id+'のファイルを作成しました。(loadText)','alert-success');var data=file_rw(FILE+id+".json",0);if(Number(id.slice(id.search('[^0]')))>=new_id){set_last_id(id)}}
var data_array=JSON.parse(data);set_memo_items(data_array)}
function saveText(id,arg1,msg_hidden){if(id===undefined){id=$('#memo_id').text()}
var items_array=get_memo_json();var data=JSON.stringify(items_array);file_rw(FILE+id+'.json',1,data);if(!(msg_hidden===1)){msg_show('管理番号: '+id+'のデータを保存しました。(saveText)','alert-success')}}
function delete_text(id){var fso=new ActiveXObject("Scripting.FileSystemObject");var last_id=get_last_id();if(id===undefined){id=$('#memo_id').text()}
try{fso.DeleteFile(FILE+id+'.json',!0)}
catch(e){msg_show('ファイル削除に失敗しました。(delete_text)','alert-danger');return}
file=null;fso=null;if(id===last_id){var new_id=Number(last_id.slice(last_id.search('[^0]')))-1;set_last_id(('00000'+new_id).slice(-5))}
msg_show('管理番号: '+id+'のファイルを削除しました。(delete_text)','alert-danger')}
function save_as(text,file_name){var data=get_memo_json();if(text===undefined){text='タイトル:'+data.title+'\r\n本文'+data.memo+'\r\ngroup1:'+data.group1+'\r\ngroup2:'+data.group2+'\r\n作成日：'+data.create_time+'\r\n最終更新日'+data.update_time}
if(file_name===undefined){file_name=data.id+'_'+data.create_time+'.txt'}
var b=new Blob(["\uFEFF",text]);if(navigator.msSaveBlob){navigator.msSaveOrOpenBlob(b,file_name)}else{var a=document.createElement('a');a.href=URL.createObjectURL(b);a.setAttribute('download',file_name);a.dispatchEvent(new CustomEvent('click'))}}
function task_add(){var new_task={"task":$('#new-task-add .task-text').val(),"type":$('#new-task-add .task-progress').val(),"start":$('#new-task-add .start').val(),"end":$('#new-task-add .end').val()};var all_task=JSON.parse(file_rw(TASK_LIST,0));all_task.push(new_task);file_rw(TASK_LIST,1,JSON.stringify(all_task,undefined,2));all_task_visible()}
function task_save(task_id){var task={"task":$('#'+task_id+' .task-text').val(),"type":$('#'+task_id+' .task-progress').val(),"start":$('#'+task_id+' .start').val(),"end":$('#'+task_id+' .end').val()};var task_num=task_id.slice(task_id.search('[^task-num-]'))
var all_task=JSON.parse(file_rw(TASK_LIST,0));all_task[task_num]=task;file_rw(TASK_LIST,1,JSON.stringify(all_task,undefined,2));all_task_visible()}
function task_all_save(){var all_task=[];for(var i=0;!0;i ++){if(document.getElementById('task-num-'+i)===null){break}
all_task[i]={"task":$('#task-num-'+i+' .task-text').val(),"type":$('#task-num-'+i+' .task-progress').val(),"start":$('#task-num-'+i+' .start').val(),"end":$('#task-num-'+i+' .end').val()}}
file_rw(TASK_LIST,1,JSON.stringify(all_task,undefined,2));all_task_visible()}
function task_del(id){var all_task=JSON.parse(file_rw(TASK_LIST,0));all_task.splice(id,id);file_rw(TASK_LIST,1,JSON.stringify(all_task,undefined,2));all_task_visible()}
function get_file_list(){var fso=new ActiveXObject('Scripting.FileSystemObject');var files=[];var e=new Enumerator(fso.GetFolder(FILE).Files);for(;!e.atEnd();e.moveNext()){var file=e.item();if(file.Name==='all_task.json'||file.Name==='last_data_file.json'){}
else{files.push(file.Name)}}
return files}
function file_rw(arg_file,rw,arg_data,arg_charset){const TYPE_BINARY=1;const TYPE_TEXT=2;const READ_ALL=-1;const READ_LINE=-2;const WRITE_CHAR=0;const WRITE_LINE=1;const SAVE_TEXT=1;const SAVE_WRITE_TEXT=2;var stream=new ActiveXObject("ADODB.Stream");stream.Type=TYPE_TEXT;var charset=["utf-8","Shift_JIS"]
if(arg_charset===undefined){arg_charset=0}
stream.charset=charset[arg_charset];stream.Mode=8;stream.Open();if(rw===0){try{stream.LoadFromFile(arg_file);var data=stream.ReadText(READ_ALL);stream.Close();stream=null;return data}catch(e){stream=null;return undefined}}else if(rw===1){try{stream.SaveToFile(arg_file,SAVE_WRITE_TEXT);stream.LoadFromFile(arg_file);stream.SetEOS();stream.WriteText(arg_data,WRITE_LINE);stream.SaveToFile(arg_file,SAVE_WRITE_TEXT);stream.Close();stream=null}catch(e){msg_show('ファイル書き込みに失敗しました。(read_ALL)','alert-danger');stream=null;return undefined}}}
function get_last_id(){var data=file_rw(LAST_DATA_FILE,0);return JSON.parse(data).last_id}
function set_last_id(id){if(id==="00000"){file_rw(LAST_DATA_FILE,1,'{"last_id": "'+"00001"+'"}')}else{file_rw(LAST_DATA_FILE,1,'{"last_id": "'+id+'"}')}}
function setWindow(height,width,stay_flg){if(width===undefined){width=NORMAL_WIDTH}
if(height===undefined){height=NORMAL_HEIGHT}
window.resizeTo(width,height)}
function msg_show(arg_msg,arg_type,fadeOut){if(arg_type===undefined){arg_type='alert-info'}
if(fadeOut===undefined){fadeOut=3000}
var random=Math.random();var html='<p id="'+random+'" class="mx-auto mb-1 alert msg-active '+arg_type+'" style="width: 95%; font-size: auto;">'+arg_msg+'</p>';$('#memo_app_msg').prepend(html);var height=window.outerHeight;var width=window.outerWidth;var tmp_msg=document.getElementById(random);var add_heigh=tmp_msg.offsetHeight+10;var add_flg=!1;if(!(height+add_heigh>=screen.height)){setWindow((height+add_heigh),width);add_flg=!0}
$('#'+random).fadeOut(fadeOut);setTimeout(function(){if(document.getElementById(random)!=null){tmp_msg.parentNode.removeChild(tmp_msg);if(add_flg){setWindow(window.outerHeight-add_heigh,window.outerWidth)}}},fadeOut)}
function acordion_move(){var height=OP_DETAILS_HEIGHT;var width=window.outerWidth;if(height<window.outerHeight-$('#memo_app_msg').height()){var height=window.outerHeight-$('#memo_app_msg').height();$(this).addClass('user-height')}
if($(this).hasClass('active')){$(this).removeClass('active');$(this).text('▽');if(!($(this).hasClass('user-height'))){setWindow($('#memo-input-form').prop("before-height")+$('#memo_app_msg').height(),width)}else{$(this).removeClass('user-height')}}else{$('#memo-input-form').prop("before-height",window.outerHeight-$('#memo_app_msg').height());setWindow(height+$('#memo_app_msg').height(),width);$(this).addClass('active');$(this).text('△')}}
function all_memo_visible(line_num,last_id){var files=get_file_list();var key_arr=["id","title","memo","create_time","update_time","hidden_flg","group1","group2"]
var height=OP_TABLE_HEIGHT;var width=OP_TABLE_WIDTH;if(!($('#all-memo').prop('user-width')===undefined&&$('#all-memo').prop('user-height')===undefined)){if($('#all-memo').prop('user-height')>window.outerHeight){height=$('#all-memo').prop('user-height')}else{height=window.outerHeight}
if($('#all-memo').prop('user-width')>window.outerWidth){width=$('#all-memo').prop('user-width')}else{width=window.outerWidth}}
setWindow(height,width);$('tbody.scrollBody').css({"height":Number(window.outerHeight-170)+"px","width":Number(window.outerWidth-18)+"px"})
$("#memo-table").empty();var wak='<tr id="th-group"><th>ID</th><th>Title</th><th>Memo</th><th>Create_Time</th><th>Update_Time</th><th>Hidden_flg</th><th>Group1</th><th>Group2</th></tr>';if(files.length<1){return}
if(last_id===undefined){var i=files.length-1}else{var i=last_id;if(last_id>=files.length){i=files.length-1}}
if(line_num===undefined){line_num=i-20}else{line_num=i-line_num}
for(i;i>=line_num&&i>=0;i--){var data_array=JSON.parse(file_rw(FILE+files[i],0));wak+='<tr class="td-group">'
for(j=0;j<key_arr.length;j++){if(j===0){wak+='<td id="memo_id--'+data_array.id+'">'}else{wak+='<td>'}
wak+=data_array[key_arr[j]]+'</td>\n'}
wak+='</tr>\n'}
wak+='<tr id="visible-last-id" class="hidden_group"><td>'+i+'</td></tr>'
$('#all-memo .latest').text(('00000'+files.length).slice(-5));$('#memo-table').append(wak);if(document.getElementById('memo_id--'+$('#all-memo .latest').text())){$('#all-memo .pre').addClass('hidden_group')}
if(document.getElementById('memo_id--00001')){$('#all-memo .next').addClass('hidden_group')}}
function all_task_visible(){var height=OP_TABLE_HEIGHT;var width=OP_TABLE_WIDTH;if(!($('#all-task').prop('user-width')===undefined&&$('#all-task').prop('user-height')===undefined)){if($('#all-task').prop('user-height')>window.outerHeight){height=$('#all-task').prop('user-height')}else{height=window.outerHeight}
if($('#all-task').prop('user-width')>window.outerWidth){width=$('#all-task').prop('user-width')}else{width=window.outerWidth}}
setWindow(height,width);$('#all-task-table').empty();$('#all-task .scrollBody').css({"height":Number(window.outerHeight-85)+"px","width":Number(window.outerWidth-18)+"px"})
var data_array=JSON.parse(file_rw(TASK_LIST,0));for(var i=data_array.length-1;i>=0;i --){var html_table='<tr id="task-num-'+i+'">'
var data=data_array[i]
html_table=html_table+'<td><textarea rows="4" class="task-text form-control" placeholder="タスクの内容"></textarea></td>'+'<td>'+'<select class="task-progress custom-select">'+'<option value="作業中">作業中</option>'+'<option value="予定">予定</option>'+'<option value="完了">完了</option>'+'<option value="保留">保留</option>'
html_table=html_table+'</select>'+'</td>'+'<td><input class="start form-control datepickr" value="'+data.start+'"></td>'+'<td><input class="end form-control datepickr" value="'+data.end+'"></td>'+'<td class="command-btn-group">'+'<span class="save btn btn-success fill-wh">保存<i class="ml-1 svg-save"></i></span>'+'<span class="del ml-1 btn btn-danger fill-wh">削除<i class="ml-1 svg-remove"></i></span>'+'</td>'
html_table=html_table+'</tr>'
$('#all-task-table').append(html_table);$('#task-num-'+i+' .task-progress').val(data.type);$('#task-num-'+i+' .task-text').val(data.task)}
svg_init()}
const FILE=location.href.replace('file:///','').replace(location.href.split('/').pop(),'/Data/json/');　
const LAST_DATA_FILE=location.href.replace('file:///','').replace(location.href.split('/').pop(),'Config/last_data_file.json');　
const FILE_LIST=location.href.replace('file:///','').replace(location.href.split('/').pop(),'Config/all_file.json');　
const TASK_LIST=location.href.replace('file:///','').replace(location.href.split('/').pop(),'Config/all_task.json');　
const USER_CONF=location.href.replace('file:///','').replace(location.href.split('/').pop(),'Config/user_config.json');　
const INDENT='  ';　　
const NORMAL_WIDTH=344;　　
const NORMAL_HEIGHT=478;　　
const OP_DETAILS_HEIGHT=615;const OP_TABLE_HEIGHT=930;const OP_TABLE_WIDTH=1100;function all_select_item_ini(){group1='<div class="row"><span class="col-3">Group2</span><select id="group1" class="custom-select detail_groups col-9"></select>	</div>'
group2='<div class="row"><span class="col-3">Group2</span><select id="group2" class="custom-select detail_groups col-9"></select>	</div>'
$('#my-list-groups').empty();$('#my-list-groups').append(group1+group2);$('#group1').empty();$('#group1').append('<option value="00">Group1</option>');$('#group1').append('<option value="01">data1-1</option>');$('#group1').append('<option value="02">data1-2</option>');$('#group1').append('<option value="03">data1-3</option>');$('#group1').append('<option value="04">data1-4</option>');$('#group1').append('<option value="05">data1-5</option>');$('#group2').empty();$('#group2').append('<option value="00">Group2</option>');$('#group2').append('<option value="01">data2-1</option>');$('#group2').append('<option value="02">data2-2</option>');$('#group2').append('<option value="03">data2-3</option>');$('#group2').append('<option value="04">data2-4</option>');$('#group2').append('<option value="05">data2-5</option>')}
function get_memo_items(){var group1_str=$('#group1').val()+':'+$('#group1 option:selected').text();var group2_str=$('#group2').val()+':'+$('#group2 option:selected').text();var result_data=[$('#memo_id').text(),$('#memo_title').val(),$('#memo_text').val(),$('#memo_create').text(),getDateTime(),0,group1_str,group2_str];return result_data}
function get_memo_json(){var val=get_memo_items();var result_json={};result_json.id=val[0];result_json.title=val[1];result_json.memo=val[2];result_json.create_time=val[3];result_json.update_time=val[4];result_json.hidden_flg=val[5];result_json.group1=val[6];result_json.group2=val[7];return result_json}
function set_memo_items(itmes){$('#memo_id').text(itmes.id);$('#memo_title').val(itmes.title);$('#memo_text').val(itmes.memo);$('#memo_create').text(itmes.create_time);$('#memo_update').text(itmes.update_time);$('#group1').val(itmes.group1.slice(0,2));$('#group2').val(itmes.group2.slice(0,2))}